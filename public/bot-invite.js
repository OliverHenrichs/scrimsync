var s=Object.defineProperty;var r=(n,e,t)=>e in n?s(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var i=(n,e,t)=>r(n,typeof e!="symbol"?e+"":e,t);class a{constructor(){i(this,"inviteButton");i(this,"loadingElement");i(this,"errorElement");this.initializeElements(),this.setupEventListeners(),this.checkAuth()}initializeElements(){this.inviteButton=document.getElementById("inviteButton"),this.loadingElement=document.getElementById("loading"),this.errorElement=document.getElementById("error")}setupEventListeners(){this.inviteButton.addEventListener("click",e=>{e.preventDefault(),this.generateInvite()})}async checkAuth(){try{(await fetch("/auth/user",{credentials:"include"})).ok||(window.location.href="/auth/login")}catch(e){console.error("Auth check failed:",e),window.location.href="/auth/login"}}async generateInvite(){this.inviteButton.style.display="none",this.loadingElement.style.display="block",this.errorElement.style.display="none";try{const e=await fetch("/api/invites/bot/invite",{method:"GET",credentials:"include",headers:{"Content-Type":"application/json"}});console.log("Response status:",e.status);const t=await e.json();if(console.log("Response data:",t),t.success&&t.data){console.log("Generated invite URL:",t.data.inviteUrl);try{window.location.href=t.data.inviteUrl}catch(o){console.error("Redirect failed:",o),window.open(t.data.inviteUrl,"_blank")}}else throw new Error(t.message||"Failed to generate invite")}catch(e){console.error("Error generating invite:",e),this.errorElement.textContent=e instanceof Error?e.message:"Failed to generate invite link. Please try again.",this.errorElement.style.display="block",this.inviteButton.style.display="inline-block"}finally{this.loadingElement.style.display="none"}}}document.addEventListener("DOMContentLoaded",()=>{new a});
